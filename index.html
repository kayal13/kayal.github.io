<!DOCTYPE html>
<html>

<head>
    <title>üåä Buoy Monitoring Dashboard</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            color: #fff;
            background: url("https://images.unsplash.com/photo-1507525428034-b723cf961d3e") no-repeat center center fixed;
            background-size: cover;
        }

        .topbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(6px);
            padding: 15px 25px;
            border-radius: 10px;
            margin-bottom: 20px;
        }

        h2 {
            color: #111;
            margin: 0;
        }

        .status {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .dot {
            height: 12px;
            width: 12px;
            border-radius: 50%;
        }

        .dot.green {
            background-color: #22c55e;
        }

        .dot.red {
            background-color: #ef4444;
        }

        .section {
            margin-bottom: 20px;
        }

        .section h3 {
            margin-bottom: 10px;
            color: #111;
            background: rgba(255, 255, 255, 0.2);
            padding: 6px 10px;
            border-radius: 6px;
            display: inline-block;
        }

        .block-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
            gap: 16px;
        }

        .block {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(8px);
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.25);
            min-height: 100px;
        }

        .block h4 {
            margin-bottom: 8px;
            font-size: 1.1em;
            color: #111;
        }

        .subvalue {
            margin: 4px 0;
        }

        .label {
            font-weight: bold;
            color: #111;
        }

        .value {
            font-size: 1.4em;
            font-weight: bold;
        }

        .unit {
            font-size: 0.9em;
            color: #e5e7eb;
        }

        /* 4K scaling */
        @media screen and (min-width: 2560px) {
            body {
                padding: 28px;
            }

            h2 {
                font-size: 2.4rem;
            }

            .section h3 {
                font-size: 1.3rem;
            }

            .block h4 {
                font-size: 1.4rem;
            }

            .value {
                font-size: 2rem;
            }

            .unit {
                font-size: 1rem;
            }

            .block-grid {
                gap: 20px;
            }
        }

        /* Laptop scaling */
        @media screen and (max-width: 1366px) {
            body {
                padding: 16px;
            }

            h2 {
                font-size: 1.6rem;
            }

            .section h3 {
                font-size: 1rem;
            }

            .block h4 {
                font-size: 1rem;
            }

            .value {
                font-size: 1.2rem;
            }

            .unit {
                font-size: 0.85rem;
            }
        }
    </style>
</head>

<body>

    <div class="topbar">
        <h2>üåä Buoy Monitoring Dashboard</h2>
        <div class="status">
            <div id="statusDot" class="dot red"></div>
            <span id="statusText">Offline</span>
            <span id="clock"></span>
        </div>
    </div>

    <div class="section">
        <h3>üå°Ô∏è Temperature</h3>
        <div class="block-grid">
            <div class="block">
                <h4>Oil</h4>
                <div class="value" id="temp_oil">--</div>
                <div class="unit">¬∞C</div>
            </div>
            <div class="block">
                <h4>Gas</h4>
                <div class="value" id="temp_gas">--</div>
                <div class="unit">¬∞C</div>
            </div>
        </div>
    </div>

    <div class="section">
        <h3>üß≠ Pressure</h3>
        <div class="block-grid">
            <div class="block">
                <h4>Oil</h4>
                <div class="value" id="pres_oil">--</div>
                <div class="unit">hPa</div>
            </div>
            <div class="block">
                <h4>Gas</h4>
                <div class="value" id="pres_gas">--</div>
                <div class="unit">hPa</div>
            </div>
        </div>
    </div>

    <div class="section">
        <h3>üí® Wind Energy</h3>
        <div class="block-grid">
            <div class="block">
                <h4>Anemometer</h4>
                <div class="value" id="wind_energy">--</div>
                <div class="unit">m/s</div>
            </div>
        </div>
    </div>

    <div class="section">
        <h3>üìç GPS</h3>
        <div class="block-grid">
            <div class="block">
                <h4>Tanker</h4>
                <div class="subvalue"><span class="label">Latitude:</span> <span id="gps_tanker_lat">--</span></div>
                <div class="subvalue"><span class="label">Longitude:</span> <span id="gps_tanker_lon">--</span></div>
            </div>
            <div class="block">
                <h4>Buoy</h4>
                <div class="subvalue"><span class="label">Latitude:</span> <span id="gps_buoy_lat">--</span></div>
                <div class="subvalue"><span class="label">Longitude:</span> <span id="gps_buoy_lon">--</span></div>
            </div>
        </div>
    </div>

    <div class="section">
        <h3>üåä ADCP Current Meter</h3>
        <div class="block-grid">
            <div class="block">
                <h4>Tide Height</h4>
                <div class="value" id="adcp_tide_height">--</div>
                <div class="unit">m</div>
            </div>
            <div class="block">
                <h4>Sig Height</h4>
                <div class="value" id="adcp_sig_height">--</div>
                <div class="unit">m</div>
            </div>
            <div class="block">
                <h4>Wave Speed</h4>
                <div class="value" id="adcp_wave_speed">--</div>
                <div class="unit">m/s</div>
            </div>
            <div class="block">
                <h4>Direction</h4>
                <div class="value" id="adcp_direction">--</div>
                <div class="unit">¬∞</div>
            </div>
            <div class="block">
                <h4>Period</h4>
                <div class="value" id="adcp_period">--</div>
                <div class="unit">s</div>
            </div>
        </div>
    </div>

    <script>
        // Clock
        setInterval(() => {
            document.getElementById("clock").innerText = new Date().toLocaleString();
        }, 1000);

        // Live updates from server
        setInterval(async () => {
            try {
                const res = await fetch("/data");
                const d = await res.json();

                if (d.plc_status === "On") {
                    document.getElementById("statusDot").className = "dot green";
                    document.getElementById("statusText").innerText = "Online (PLC On)";
                } else {
                    document.getElementById("statusDot").className = "dot red";
                    document.getElementById("statusText").innerText = "Offline / PLC Off";
                }

                document.getElementById("temp_oil").innerText = d.temp_oil ?? "--";
                document.getElementById("temp_gas").innerText = d.temp_gas ?? "--";
                document.getElementById("pres_oil").innerText = d.pres_oil ?? "--";
                document.getElementById("pres_gas").innerText = d.pres_gas ?? "--";
                document.getElementById("wind_energy").innerText = d.wind_energy ?? "--";

                document.getElementById("gps_tanker_lat").innerText = d.gps_tanker_lat ?? "--";
                document.getElementById("gps_tanker_lon").innerText = d.gps_tanker_lon ?? "--";
                document.getElementById("gps_buoy_lat").innerText = d.gps_buoy_lat ?? "--";
                document.getElementById("gps_buoy_lon").innerText = d.gps_buoy_lon ?? "--";

                document.getElementById("adcp_tide_height").innerText = d.adcp_tide_height ?? "--";
                document.getElementById("adcp_sig_height").innerText = d.adcp_sig_height ?? "--";
                document.getElementById("adcp_wave_speed").innerText = d.adcp_wave_speed ?? "--";
                document.getElementById("adcp_direction").innerText = d.adcp_direction ?? "--";
                document.getElementById("adcp_period").innerText = d.adcp_period ?? "--";
            } catch (e) {
                document.getElementById("statusDot").className = "dot red";
                document.getElementById("statusText").innerText = "Error fetching data";
            }
        }, 2000);
    </script>

</body>

</html>